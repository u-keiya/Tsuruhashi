## Summary
本セッションでは Issue #10 (US-003) の実装を行い、ToolManager にツール自動装備（pickup）と耐久0時の自動交換を追加しました。  
実装はユニットテスト（sinon + chai）を追加した上でローカル実行し、全テスト通過・Lint通過を確認しています。  
Pull Request #20 を作成済みでレビュー待ちです。

### User Requirement
- ツール拾得時に自動装備すること（ToolManager.pickup(item) で equip）  
- 耐久度が0になった場合、インベントリの予備ツールへ自動交換すること（なければ採掘停止）  
- 単体テストが通ること  
(USDM: `US-003`)

### Key Decisions
- ツール判定は Item に `durability` と `maxDurability` が存在してかつ正の値であることとした（実装簡潔性と既存型との親和性）。  
- 自動装備は「現在装備ツールが無い場合のみ」行う仕様とした（既存の装備切替ロジックと競合しないため）。  
- 破損検知時はまず `inventory.nextUsableTool()` を呼び、存在すれば `miningEngine.equip()` で交換、無ければ `miningEngine.stopDig()` とチャット通知を行う。  
- 実装は設計図 [`docs/03_design/diagrams/sequence/tool_break_swap.puml`](docs/03_design/diagrams/sequence/tool_break_swap.puml:16) に準拠。

### Action Items
- [ ] Code Reviewer: Pull Request #20 をレビューし LGTM または 指摘を返す (role: Code Reviewer)  
- [ ] Test Engineer: インテグレーション環境で bedrock サーバを使った実動作確認を実施して結果を報告 (role: Test Engineer)  
- [ ] Developer: レビュー指摘へ対応、CI 通過後に main へマージ (role: Developer)  
- [ ] Documentation Synthesizer: 本ファイル保存後、再利用可能なプロンプトがあれば `docs/04_dev/ai_prompts.md` に追記 (role: DS)

### Files changed (主要)
- [`src/engine/toolManager.ts`](src/engine/toolManager.ts:1) — pickup(), `InventoryLike`, `Item` 型追加、`handleToolBreak` 拡張  
- [`tests/unit/toolManager.test.ts`](tests/unit/toolManager.test.ts:1) — pickup / auto-swap のユニットテスト追加

### Test / CI
- ローカル実行: `npm test` → 全75テスト通過（ローカル）  
- Lint: `npm run lint` → エラー無し（既存の console に関する警告が残るがエラーではない）

### References
- Issue: https://github.com/u-keiya/Tsuruhashi/issues/10  
- Pull Request: https://github.com/u-keiya/Tsuruhashi/pull/20  
- USDM: [`docs/02_requirements/usdm/US-003.yaml`](docs/02_requirements/usdm/US-003.yaml:1)  
- Sequence diagram: [`docs/03_design/diagrams/sequence/tool_break_swap.puml`](docs/03_design/diagrams/sequence/tool_break_swap.puml:1)

### Open Questions
- 自動装備を「未装備時のみ」とした判断で合意済みか（もし常時上書きしたい場合は要指示） — (role: PO)  
- 実ボットの InventoryPlugin 実装（InventoryLike の具体実装）について詳細設計が必要であれば SA にエスカレーションしてください。